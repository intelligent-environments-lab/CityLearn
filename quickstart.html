

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QuickStart &mdash; CityLearn 2.3.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx-dropdown.css?v=995e94df" />
      <link rel="stylesheet" type="text/css" href="_static/panels-bootstrap.min.css?v=21c0b90a" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=67b02a41"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Overview" href="overview/index.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CityLearn
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">QuickStart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#CityLearn-Control-Agents">CityLearn Control Agents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#No-Control-(Baseline)">No Control (Baseline)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Centralized-RBC">Centralized RBC</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Decentralized-Independent-SAC">Decentralized-Independent SAC</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Decentralized-Cooperative-MARLISA">Decentralized-Cooperative MARLISA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Other-Standard-Reinforcement-Learning-Libraries">Other Standard Reinforcement Learning Libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Stable-Baselines3-Reinforcement-Learning-Algorithms">Stable Baselines3 Reinforcement Learning Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#RLlib">RLlib</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Single-Agent">Single Agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Multi-agent">Multi-agent</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Neighborhood-Dataset-Generation">Neighborhood Dataset Generation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/index.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">citylearn</a></li>
<li class="toctree-l1"><a class="reference internal" href="citylearn_challenge/index.html">The CityLearn Challenge</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CityLearn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">QuickStart</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/intelligent-environments-lab/CityLearn/blob/master/docs/source/quickstart.nblink" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></p>
<section id="QuickStart">
<h1>QuickStart<a class="headerlink" href="#QuickStart" title="Link to this heading"></a></h1>
<p>Install the latest CityLearn version from PyPi with the :code:<code class="docutils literal notranslate"><span class="pre">pip</span></code> command:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>CityLearn
</pre></div>
</div>
</div>
<section id="CityLearn-Control-Agents">
<h2>CityLearn Control Agents<a class="headerlink" href="#CityLearn-Control-Agents" title="Link to this heading"></a></h2>
<section id="No-Control-(Baseline)">
<h3>No Control (Baseline)<a class="headerlink" href="#No-Control-(Baseline)" title="Link to this heading"></a></h3>
<p>Run the following to simulate an environment where the storage systems and heat pumps are not controlled (baseline). The storage actions prescribed will be 0.0 and the heat pump will have no action, i.e. <code class="docutils literal notranslate"><span class="pre">None</span></code>, causing it to deliver the ideal load in the building time series files:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.agents.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaselineAgent</span> <span class="k">as</span> <span class="n">Agent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.citylearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">CityLearnEnv</span>

<span class="c1"># initialize</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CityLearnEnv</span><span class="p">(</span><span class="s1">&#39;citylearn_challenge_2023_phase_2_local_evaluation&#39;</span><span class="p">,</span> <span class="n">central_agent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>

<span class="c1"># step through environment and apply agent actions</span>
<span class="n">observations</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="k">while</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">terminated</span><span class="p">:</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
    <span class="n">observations</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">terminated</span><span class="p">,</span> <span class="n">truncated</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="c1"># test</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;cost_function&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/kingsleyenweye/Desktop/INTELLIGENT_ENVIRONMENT_LAB/citylearn/CityLearn/test-py311-env/lib/python3.11/site-packages/gymnasium/spaces/box.py:130: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  gym.logger.warn(f&#34;Box bound precision lowered by casting to {self.dtype}&#34;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>name</th>
      <th>Building_1</th>
      <th>Building_2</th>
      <th>Building_3</th>
      <th>District</th>
    </tr>
    <tr>
      <th>cost_function</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>all_time_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>annual_normalized_unserved_energy_total</th>
      <td>0.019</td>
      <td>0.018</td>
      <td>0.018</td>
      <td>0.018</td>
    </tr>
    <tr>
      <th>carbon_emissions_total</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>cost_total</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>daily_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>daily_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_average</th>
      <td>1.657</td>
      <td>0.045</td>
      <td>0.675</td>
      <td>0.793</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_maximum</th>
      <td>4.878</td>
      <td>1.793</td>
      <td>3.642</td>
      <td>3.438</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_cold_proportion</th>
      <td>0.369</td>
      <td>0.000</td>
      <td>0.095</td>
      <td>0.155</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_average</th>
      <td>0.053</td>
      <td>0.577</td>
      <td>0.081</td>
      <td>0.237</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_maximum</th>
      <td>5.006</td>
      <td>6.441</td>
      <td>3.734</td>
      <td>5.060</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_hot_proportion</th>
      <td>0.008</td>
      <td>0.041</td>
      <td>0.003</td>
      <td>0.018</td>
    </tr>
    <tr>
      <th>discomfort_proportion</th>
      <td>0.377</td>
      <td>0.041</td>
      <td>0.098</td>
      <td>0.172</td>
    </tr>
    <tr>
      <th>electricity_consumption_total</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>monthly_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>one_minus_thermal_resilience_proportion</th>
      <td>0.333</td>
      <td>0.643</td>
      <td>0.133</td>
      <td>0.370</td>
    </tr>
    <tr>
      <th>power_outage_normalized_unserved_energy_total</th>
      <td>0.723</td>
      <td>0.692</td>
      <td>0.637</td>
      <td>0.684</td>
    </tr>
    <tr>
      <th>ramping_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>zero_net_energy</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Centralized-RBC">
<h3>Centralized RBC<a class="headerlink" href="#Centralized-RBC" title="Link to this heading"></a></h3>
<p>Run the following to simulate an environment controlled by centralized RBC agent for a single episode:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.agents.rbc</span><span class="w"> </span><span class="kn">import</span> <span class="n">BasicRBC</span> <span class="k">as</span> <span class="n">Agent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.citylearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">CityLearnEnv</span>

<span class="c1"># initialize</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CityLearnEnv</span><span class="p">(</span><span class="s1">&#39;citylearn_challenge_2023_phase_2_local_evaluation&#39;</span><span class="p">,</span> <span class="n">central_agent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>

<span class="c1"># step through environment and apply agent actions</span>
<span class="n">observations</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="k">while</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">terminated</span><span class="p">:</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
    <span class="n">observations</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">terminated</span><span class="p">,</span> <span class="n">truncated</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="c1"># test</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;cost_function&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>name</th>
      <th>Building_1</th>
      <th>Building_2</th>
      <th>Building_3</th>
      <th>District</th>
    </tr>
    <tr>
      <th>cost_function</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>all_time_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.179</td>
    </tr>
    <tr>
      <th>annual_normalized_unserved_energy_total</th>
      <td>0.017</td>
      <td>0.016</td>
      <td>0.016</td>
      <td>0.016</td>
    </tr>
    <tr>
      <th>carbon_emissions_total</th>
      <td>1.998</td>
      <td>1.936</td>
      <td>1.740</td>
      <td>1.891</td>
    </tr>
    <tr>
      <th>cost_total</th>
      <td>1.931</td>
      <td>1.878</td>
      <td>1.713</td>
      <td>1.841</td>
    </tr>
    <tr>
      <th>daily_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.720</td>
    </tr>
    <tr>
      <th>daily_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.352</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_average</th>
      <td>9.825</td>
      <td>3.493</td>
      <td>3.189</td>
      <td>5.502</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_maximum</th>
      <td>13.774</td>
      <td>9.875</td>
      <td>5.514</td>
      <td>9.721</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_cold_proportion</th>
      <td>0.975</td>
      <td>0.899</td>
      <td>0.953</td>
      <td>0.942</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_average</th>
      <td>0.005</td>
      <td>0.022</td>
      <td>0.010</td>
      <td>0.012</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_maximum</th>
      <td>1.456</td>
      <td>4.526</td>
      <td>3.230</td>
      <td>3.071</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_hot_proportion</th>
      <td>0.000</td>
      <td>0.007</td>
      <td>0.003</td>
      <td>0.004</td>
    </tr>
    <tr>
      <th>discomfort_proportion</th>
      <td>0.975</td>
      <td>0.907</td>
      <td>0.957</td>
      <td>0.946</td>
    </tr>
    <tr>
      <th>electricity_consumption_total</th>
      <td>1.995</td>
      <td>1.963</td>
      <td>1.755</td>
      <td>1.904</td>
    </tr>
    <tr>
      <th>monthly_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.863</td>
    </tr>
    <tr>
      <th>one_minus_thermal_resilience_proportion</th>
      <td>0.667</td>
      <td>0.500</td>
      <td>0.267</td>
      <td>0.478</td>
    </tr>
    <tr>
      <th>power_outage_normalized_unserved_energy_total</th>
      <td>0.781</td>
      <td>0.759</td>
      <td>0.711</td>
      <td>0.750</td>
    </tr>
    <tr>
      <th>ramping_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.959</td>
    </tr>
    <tr>
      <th>zero_net_energy</th>
      <td>2.059</td>
      <td>1.994</td>
      <td>1.773</td>
      <td>1.942</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Decentralized-Independent-SAC">
<h3>Decentralized-Independent SAC<a class="headerlink" href="#Decentralized-Independent-SAC" title="Link to this heading"></a></h3>
<p>Run the following to simulate an environment controlled by decentralized-independent SAC agents for 1 training episode:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.agents.sac</span><span class="w"> </span><span class="kn">import</span> <span class="n">SAC</span> <span class="k">as</span> <span class="n">Agent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.citylearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">CityLearnEnv</span>

<span class="c1"># initialize</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CityLearnEnv</span><span class="p">(</span><span class="s1">&#39;citylearn_challenge_2023_phase_2_local_evaluation&#39;</span><span class="p">,</span> <span class="n">central_agent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>

<span class="c1"># train</span>
<span class="n">model</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">episodes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">deterministic_finish</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># test</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;cost_function&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>name</th>
      <th>Building_1</th>
      <th>Building_2</th>
      <th>Building_3</th>
      <th>District</th>
    </tr>
    <tr>
      <th>cost_function</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>all_time_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.949</td>
    </tr>
    <tr>
      <th>annual_normalized_unserved_energy_total</th>
      <td>0.013</td>
      <td>0.013</td>
      <td>0.012</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>carbon_emissions_total</th>
      <td>0.942</td>
      <td>0.974</td>
      <td>0.952</td>
      <td>0.956</td>
    </tr>
    <tr>
      <th>cost_total</th>
      <td>0.904</td>
      <td>0.935</td>
      <td>0.920</td>
      <td>0.920</td>
    </tr>
    <tr>
      <th>daily_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.941</td>
    </tr>
    <tr>
      <th>daily_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.930</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_average</th>
      <td>1.944</td>
      <td>0.922</td>
      <td>0.919</td>
      <td>1.262</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_maximum</th>
      <td>6.454</td>
      <td>4.517</td>
      <td>3.080</td>
      <td>4.684</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_cold_proportion</th>
      <td>0.459</td>
      <td>0.319</td>
      <td>0.268</td>
      <td>0.349</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_average</th>
      <td>0.235</td>
      <td>0.537</td>
      <td>0.278</td>
      <td>0.350</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_maximum</th>
      <td>4.578</td>
      <td>6.119</td>
      <td>3.914</td>
      <td>4.871</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_hot_proportion</th>
      <td>0.039</td>
      <td>0.149</td>
      <td>0.028</td>
      <td>0.072</td>
    </tr>
    <tr>
      <th>discomfort_proportion</th>
      <td>0.498</td>
      <td>0.468</td>
      <td>0.296</td>
      <td>0.421</td>
    </tr>
    <tr>
      <th>electricity_consumption_total</th>
      <td>0.952</td>
      <td>0.992</td>
      <td>0.966</td>
      <td>0.970</td>
    </tr>
    <tr>
      <th>monthly_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.994</td>
    </tr>
    <tr>
      <th>one_minus_thermal_resilience_proportion</th>
      <td>0.733</td>
      <td>0.500</td>
      <td>0.133</td>
      <td>0.456</td>
    </tr>
    <tr>
      <th>power_outage_normalized_unserved_energy_total</th>
      <td>0.625</td>
      <td>0.648</td>
      <td>0.596</td>
      <td>0.623</td>
    </tr>
    <tr>
      <th>ramping_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.883</td>
    </tr>
    <tr>
      <th>zero_net_energy</th>
      <td>0.967</td>
      <td>0.994</td>
      <td>0.967</td>
      <td>0.976</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Decentralized-Cooperative-MARLISA">
<h3>Decentralized-Cooperative MARLISA<a class="headerlink" href="#Decentralized-Cooperative-MARLISA" title="Link to this heading"></a></h3>
<p>Run the following to simulate an environment controlled by decentralized-cooperative MARLISA agents for 1 training episodes:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.agents.marlisa</span><span class="w"> </span><span class="kn">import</span> <span class="n">MARLISA</span> <span class="k">as</span> <span class="n">Agent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.citylearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">CityLearnEnv</span>

<span class="c1"># initialize</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CityLearnEnv</span><span class="p">(</span><span class="s1">&#39;citylearn_challenge_2023_phase_2_local_evaluation&#39;</span><span class="p">,</span> <span class="n">central_agent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>

<span class="c1"># train</span>
<span class="n">model</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">episodes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">deterministic_finish</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># test</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;cost_function&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>name</th>
      <th>Building_1</th>
      <th>Building_2</th>
      <th>Building_3</th>
      <th>District</th>
    </tr>
    <tr>
      <th>cost_function</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>all_time_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.949</td>
    </tr>
    <tr>
      <th>annual_normalized_unserved_energy_total</th>
      <td>0.013</td>
      <td>0.013</td>
      <td>0.012</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>carbon_emissions_total</th>
      <td>0.954</td>
      <td>0.975</td>
      <td>0.961</td>
      <td>0.963</td>
    </tr>
    <tr>
      <th>cost_total</th>
      <td>0.916</td>
      <td>0.936</td>
      <td>0.929</td>
      <td>0.927</td>
    </tr>
    <tr>
      <th>daily_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.938</td>
    </tr>
    <tr>
      <th>daily_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.934</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_average</th>
      <td>1.961</td>
      <td>0.917</td>
      <td>0.892</td>
      <td>1.256</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_maximum</th>
      <td>6.487</td>
      <td>4.553</td>
      <td>3.040</td>
      <td>4.693</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_cold_proportion</th>
      <td>0.459</td>
      <td>0.317</td>
      <td>0.250</td>
      <td>0.342</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_average</th>
      <td>0.235</td>
      <td>0.550</td>
      <td>0.295</td>
      <td>0.360</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_maximum</th>
      <td>4.590</td>
      <td>6.210</td>
      <td>3.938</td>
      <td>4.913</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_hot_proportion</th>
      <td>0.041</td>
      <td>0.153</td>
      <td>0.030</td>
      <td>0.075</td>
    </tr>
    <tr>
      <th>discomfort_proportion</th>
      <td>0.499</td>
      <td>0.470</td>
      <td>0.280</td>
      <td>0.416</td>
    </tr>
    <tr>
      <th>electricity_consumption_total</th>
      <td>0.964</td>
      <td>0.993</td>
      <td>0.975</td>
      <td>0.977</td>
    </tr>
    <tr>
      <th>monthly_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.992</td>
    </tr>
    <tr>
      <th>one_minus_thermal_resilience_proportion</th>
      <td>0.733</td>
      <td>0.500</td>
      <td>0.133</td>
      <td>0.456</td>
    </tr>
    <tr>
      <th>power_outage_normalized_unserved_energy_total</th>
      <td>0.631</td>
      <td>0.647</td>
      <td>0.597</td>
      <td>0.625</td>
    </tr>
    <tr>
      <th>ramping_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.883</td>
    </tr>
    <tr>
      <th>zero_net_energy</th>
      <td>0.980</td>
      <td>0.996</td>
      <td>0.976</td>
      <td>0.984</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="Other-Standard-Reinforcement-Learning-Libraries">
<h2>Other Standard Reinforcement Learning Libraries<a class="headerlink" href="#Other-Standard-Reinforcement-Learning-Libraries" title="Link to this heading"></a></h2>
<section id="Stable-Baselines3-Reinforcement-Learning-Algorithms">
<h3>Stable Baselines3 Reinforcement Learning Algorithms<a class="headerlink" href="#Stable-Baselines3-Reinforcement-Learning-Algorithms" title="Link to this heading"></a></h3>
<p>Install the latest version of Stable Baselines3:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;stable-baselines3&lt;=2.2.1&quot;</span>
</pre></div>
</div>
</div>
<p>Before the environment is ready for use in Stable Baselines3, it needs to be wrapped. Firstly, wrap the environment using the <code class="docutils literal notranslate"><span class="pre">NormalizedObservationWrapper</span></code> (see <a class="reference external" href="https://www.citylearn.net/api/citylearn.wrappers.html#citylearn.wrappers.NormalizedObservationWrapper">docs</a>) to ensure that observations served to the agent are min-max normalized between [0, 1] and cyclical observations e.g. hour, are encoded using the cosine transformation.</p>
<p>Next, we wrap with the <code class="docutils literal notranslate"><span class="pre">StableBaselines3Wrapper</span></code> (see <a class="reference external" href="https://www.citylearn.net/api/citylearn.wrappers.html#citylearn.wrappers.StableBaselines3Wrapper">docs</a>) that ensures observations, actions and rewards are served in manner that is compatible with Stable Baselines3 interface.</p>
<blockquote>
<div><p>⚠️ <strong>NOTE</strong>: <code class="docutils literal notranslate"><span class="pre">central_agent</span></code> in the <code class="docutils literal notranslate"><span class="pre">env</span></code> must be <code class="docutils literal notranslate"><span class="pre">True</span></code> when using Stable Baselines3 as it does not support multi-agents.</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">stable_baselines3.sac</span><span class="w"> </span><span class="kn">import</span> <span class="n">SAC</span> <span class="k">as</span> <span class="n">Agent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.citylearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">CityLearnEnv</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.wrappers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NormalizedObservationWrapper</span><span class="p">,</span> <span class="n">StableBaselines3Wrapper</span>

<span class="c1"># initialize</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CityLearnEnv</span><span class="p">(</span><span class="s1">&#39;citylearn_challenge_2023_phase_2_local_evaluation&#39;</span><span class="p">,</span> <span class="n">central_agent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">NormalizedObservationWrapper</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">StableBaselines3Wrapper</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="s1">&#39;MlpPolicy&#39;</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>

<span class="c1"># train</span>
<span class="n">episodes</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">model</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">total_timesteps</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">unwrapped</span><span class="o">.</span><span class="n">time_steps</span><span class="o">*</span><span class="n">episodes</span><span class="p">)</span>

<span class="c1"># test</span>
<span class="n">observations</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="k">while</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">unwrapped</span><span class="o">.</span><span class="n">terminated</span><span class="p">:</span>
    <span class="n">actions</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">observations</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">observations</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="n">kpis</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">unwrapped</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;cost_function&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>name</th>
      <th>Building_1</th>
      <th>Building_2</th>
      <th>Building_3</th>
      <th>District</th>
    </tr>
    <tr>
      <th>cost_function</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>all_time_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.850</td>
    </tr>
    <tr>
      <th>annual_normalized_unserved_energy_total</th>
      <td>0.015</td>
      <td>0.011</td>
      <td>0.014</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>carbon_emissions_total</th>
      <td>0.380</td>
      <td>0.584</td>
      <td>0.504</td>
      <td>0.489</td>
    </tr>
    <tr>
      <th>cost_total</th>
      <td>0.360</td>
      <td>0.557</td>
      <td>0.472</td>
      <td>0.463</td>
    </tr>
    <tr>
      <th>daily_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.257</td>
    </tr>
    <tr>
      <th>daily_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.710</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_average</th>
      <td>0.000</td>
      <td>0.019</td>
      <td>0.001</td>
      <td>0.007</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_maximum</th>
      <td>0.124</td>
      <td>1.107</td>
      <td>0.394</td>
      <td>0.542</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_cold_proportion</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_average</th>
      <td>9.430</td>
      <td>2.862</td>
      <td>8.032</td>
      <td>6.774</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_maximum</th>
      <td>16.678</td>
      <td>10.866</td>
      <td>13.410</td>
      <td>13.651</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_hot_proportion</th>
      <td>0.982</td>
      <td>0.722</td>
      <td>0.978</td>
      <td>0.894</td>
    </tr>
    <tr>
      <th>discomfort_proportion</th>
      <td>0.982</td>
      <td>0.722</td>
      <td>0.978</td>
      <td>0.894</td>
    </tr>
    <tr>
      <th>electricity_consumption_total</th>
      <td>0.384</td>
      <td>0.593</td>
      <td>0.509</td>
      <td>0.495</td>
    </tr>
    <tr>
      <th>monthly_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.114</td>
    </tr>
    <tr>
      <th>one_minus_thermal_resilience_proportion</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>power_outage_normalized_unserved_energy_total</th>
      <td>0.566</td>
      <td>0.518</td>
      <td>0.556</td>
      <td>0.547</td>
    </tr>
    <tr>
      <th>ramping_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.896</td>
    </tr>
    <tr>
      <th>zero_net_energy</th>
      <td>0.265</td>
      <td>0.594</td>
      <td>0.454</td>
      <td>0.437</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="RLlib">
<h3>RLlib<a class="headerlink" href="#RLlib" title="Link to this heading"></a></h3>
<p>Install the latest version of RLlib:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;ray[rllib]&lt;=2.10.0&quot;</span>
</pre></div>
</div>
</div>
<p>We advise that you include the <code class="docutils literal notranslate"><span class="pre">ClippedObservationWrapper</span></code> (see <a class="reference external" href="https://www.citylearn.net/api/citylearn.wrappers.html#citylearn.wrappers.ClippedObservationWrapper">docs</a>) wrapper when working with RLlib so that observations are always clipped within the observation space before sending to the agent if not, out-of-bound observations will raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> and terminate the training.</p>
<p>We also wrap the environment with <code class="docutils literal notranslate"><span class="pre">NormalizedObservationWrapper</span></code> (see <a class="reference external" href="https://www.citylearn.net/api/citylearn.wrappers.html#citylearn.wrappers.NormalizedObservationWrapper">docs</a>) to ensure that observations served to the agent are min-max normalized between [0, 1] and cyclical observations e.g. hour, are encoded using the cosine transformation.</p>
<p>RLlib supports both <a class="reference external" href="https://docs.ray.io/en/latest/rllib/rllib-algorithms.html">single-agent and multi-agent algorithms</a>. See below for an example for either case.</p>
<section id="Single-Agent">
<h4>Single Agent<a class="headerlink" href="#Single-Agent" title="Link to this heading"></a></h4>
<p>The single-agent interface for RLlib is the <code class="docutils literal notranslate"><span class="pre">RLlibSingleAgentWrapper</span></code> wrapper.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.wrappers</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClippedObservationWrapper</span><span class="p">,</span> <span class="n">NormalizedObservationWrapper</span><span class="p">,</span> <span class="n">RLlibSingleAgentWrapper</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ray.rllib.algorithms.sac</span><span class="w"> </span><span class="kn">import</span> <span class="n">SACConfig</span> <span class="k">as</span> <span class="n">Config</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>

<span class="c1"># initialize</span>
<span class="n">env_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;env_kwargs&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;schema&#39;</span><span class="p">:</span> <span class="s1">&#39;citylearn_challenge_2023_phase_2_local_evaluation&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;wrappers&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">NormalizedObservationWrapper</span><span class="p">,</span>
        <span class="n">ClippedObservationWrapper</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Config</span><span class="p">()</span>
    <span class="o">.</span><span class="n">environment</span><span class="p">(</span><span class="n">RLlibSingleAgentWrapper</span><span class="p">,</span> <span class="n">env_config</span><span class="o">=</span><span class="n">env_config</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

<span class="c1"># train</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="c1"># test</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">RLlibSingleAgentWrapper</span><span class="p">(</span><span class="n">env_config</span><span class="p">)</span>
<span class="n">observations</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="k">while</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">unwrapped</span><span class="o">.</span><span class="n">terminated</span><span class="p">:</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">compute_single_action</span><span class="p">(</span><span class="n">observations</span><span class="p">,</span> <span class="n">explore</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">observations</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="n">kpis</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">unwrapped</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;cost_function&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-08-10 07:41:31,195 WARNING deprecation.py:50 -- DeprecationWarning: `rllib/algorithms/simple_q/` has been deprecated. Use `rllib_contrib/simple_q/` instead. This will raise an error in the future!
2025-08-10 07:41:33,448 WARNING env.py:162 -- Your env doesn&#39;t have a .spec.max_episode_steps attribute. Your horizon will default to infinity, and your environment will not be reset.
2025-08-10 07:41:33,807 WARNING util.py:62 -- Install gputil for GPU system monitoring.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>name</th>
      <th>Building_1</th>
      <th>Building_2</th>
      <th>Building_3</th>
      <th>District</th>
    </tr>
    <tr>
      <th>cost_function</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>all_time_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.063</td>
    </tr>
    <tr>
      <th>annual_normalized_unserved_energy_total</th>
      <td>0.015</td>
      <td>0.016</td>
      <td>0.014</td>
      <td>0.015</td>
    </tr>
    <tr>
      <th>carbon_emissions_total</th>
      <td>1.630</td>
      <td>1.593</td>
      <td>1.458</td>
      <td>1.560</td>
    </tr>
    <tr>
      <th>cost_total</th>
      <td>1.570</td>
      <td>1.543</td>
      <td>1.427</td>
      <td>1.513</td>
    </tr>
    <tr>
      <th>daily_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.741</td>
    </tr>
    <tr>
      <th>daily_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.165</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_average</th>
      <td>7.843</td>
      <td>2.918</td>
      <td>2.581</td>
      <td>4.448</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_maximum</th>
      <td>12.452</td>
      <td>8.403</td>
      <td>5.322</td>
      <td>8.726</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_cold_proportion</th>
      <td>0.969</td>
      <td>0.741</td>
      <td>0.765</td>
      <td>0.825</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_average</th>
      <td>0.011</td>
      <td>0.088</td>
      <td>0.013</td>
      <td>0.037</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_maximum</th>
      <td>2.275</td>
      <td>5.453</td>
      <td>3.477</td>
      <td>3.735</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_hot_proportion</th>
      <td>0.001</td>
      <td>0.017</td>
      <td>0.003</td>
      <td>0.007</td>
    </tr>
    <tr>
      <th>discomfort_proportion</th>
      <td>0.971</td>
      <td>0.757</td>
      <td>0.769</td>
      <td>0.832</td>
    </tr>
    <tr>
      <th>electricity_consumption_total</th>
      <td>1.641</td>
      <td>1.621</td>
      <td>1.478</td>
      <td>1.580</td>
    </tr>
    <tr>
      <th>monthly_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.891</td>
    </tr>
    <tr>
      <th>one_minus_thermal_resilience_proportion</th>
      <td>0.733</td>
      <td>0.643</td>
      <td>0.267</td>
      <td>0.548</td>
    </tr>
    <tr>
      <th>power_outage_normalized_unserved_energy_total</th>
      <td>0.782</td>
      <td>0.796</td>
      <td>0.707</td>
      <td>0.762</td>
    </tr>
    <tr>
      <th>ramping_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.885</td>
    </tr>
    <tr>
      <th>zero_net_energy</th>
      <td>1.685</td>
      <td>1.637</td>
      <td>1.487</td>
      <td>1.603</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Multi-agent">
<h4>Multi-agent<a class="headerlink" href="#Multi-agent" title="Link to this heading"></a></h4>
<p>The multi-agent interface for RLlib is the <code class="docutils literal notranslate"><span class="pre">RLlibMultiAgentEnv</span></code> wrapper.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.wrappers</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClippedObservationWrapper</span><span class="p">,</span> <span class="n">NormalizedObservationWrapper</span><span class="p">,</span> <span class="n">RLlibMultiAgentEnv</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ray.rllib.algorithms.sac</span><span class="w"> </span><span class="kn">import</span> <span class="n">SACConfig</span> <span class="k">as</span> <span class="n">Config</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ray.rllib.policy.policy</span><span class="w"> </span><span class="kn">import</span> <span class="n">PolicySpec</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>

<span class="c1"># initialize</span>
<span class="n">env_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;env_kwargs&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;schema&#39;</span><span class="p">:</span> <span class="s1">&#39;citylearn_challenge_2023_phase_2_local_evaluation&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;wrappers&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">NormalizedObservationWrapper</span><span class="p">,</span>
        <span class="n">ClippedObservationWrapper</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Config</span><span class="p">()</span>
    <span class="o">.</span><span class="n">environment</span><span class="p">(</span><span class="n">RLlibMultiAgentEnv</span><span class="p">,</span> <span class="n">env_config</span><span class="o">=</span><span class="n">env_config</span><span class="p">)</span>
    <span class="o">.</span><span class="n">multi_agent</span><span class="p">(</span>
        <span class="n">policies</span><span class="o">=</span><span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="n">PolicySpec</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">RLlibMultiAgentEnv</span><span class="p">(</span><span class="n">env_config</span><span class="p">)</span><span class="o">.</span><span class="n">_agent_ids</span><span class="p">},</span>
        <span class="n">policy_mapping_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">agent_id</span><span class="p">,</span> <span class="n">episode</span><span class="p">,</span> <span class="n">worker</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">agent_id</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

<span class="c1"># train</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="c1"># test</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">RLlibMultiAgentEnv</span><span class="p">(</span><span class="n">env_config</span><span class="p">)</span>
<span class="n">observations</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="k">while</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">terminated</span><span class="p">:</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">compute_single_action</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">policy_id</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">explore</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">observations</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="n">observations</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="n">kpis</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">unwrapped</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;cost_function&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-08-10 07:42:20,581 WARNING util.py:62 -- Install gputil for GPU system monitoring.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>name</th>
      <th>Building_1</th>
      <th>Building_2</th>
      <th>Building_3</th>
      <th>District</th>
    </tr>
    <tr>
      <th>cost_function</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>all_time_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.063</td>
    </tr>
    <tr>
      <th>annual_normalized_unserved_energy_total</th>
      <td>0.015</td>
      <td>0.016</td>
      <td>0.014</td>
      <td>0.015</td>
    </tr>
    <tr>
      <th>carbon_emissions_total</th>
      <td>1.639</td>
      <td>1.595</td>
      <td>1.459</td>
      <td>1.564</td>
    </tr>
    <tr>
      <th>cost_total</th>
      <td>1.579</td>
      <td>1.544</td>
      <td>1.428</td>
      <td>1.517</td>
    </tr>
    <tr>
      <th>daily_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.740</td>
    </tr>
    <tr>
      <th>daily_peak_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.167</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_average</th>
      <td>7.907</td>
      <td>2.924</td>
      <td>2.584</td>
      <td>4.471</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_maximum</th>
      <td>12.499</td>
      <td>8.406</td>
      <td>5.322</td>
      <td>8.742</td>
    </tr>
    <tr>
      <th>discomfort_cold_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_cold_proportion</th>
      <td>0.969</td>
      <td>0.743</td>
      <td>0.764</td>
      <td>0.825</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_average</th>
      <td>0.011</td>
      <td>0.087</td>
      <td>0.013</td>
      <td>0.037</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_maximum</th>
      <td>2.255</td>
      <td>5.451</td>
      <td>3.476</td>
      <td>3.728</td>
    </tr>
    <tr>
      <th>discomfort_hot_delta_minimum</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>discomfort_hot_proportion</th>
      <td>0.001</td>
      <td>0.017</td>
      <td>0.003</td>
      <td>0.007</td>
    </tr>
    <tr>
      <th>discomfort_proportion</th>
      <td>0.971</td>
      <td>0.759</td>
      <td>0.767</td>
      <td>0.832</td>
    </tr>
    <tr>
      <th>electricity_consumption_total</th>
      <td>1.650</td>
      <td>1.622</td>
      <td>1.479</td>
      <td>1.584</td>
    </tr>
    <tr>
      <th>monthly_one_minus_load_factor_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.890</td>
    </tr>
    <tr>
      <th>one_minus_thermal_resilience_proportion</th>
      <td>0.733</td>
      <td>0.643</td>
      <td>0.267</td>
      <td>0.548</td>
    </tr>
    <tr>
      <th>power_outage_normalized_unserved_energy_total</th>
      <td>0.783</td>
      <td>0.796</td>
      <td>0.707</td>
      <td>0.762</td>
    </tr>
    <tr>
      <th>ramping_average</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.884</td>
    </tr>
    <tr>
      <th>zero_net_energy</th>
      <td>1.695</td>
      <td>1.638</td>
      <td>1.488</td>
      <td>1.607</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
</section>
<section id="Neighborhood-Dataset-Generation">
<h2>Neighborhood Dataset Generation<a class="headerlink" href="#Neighborhood-Dataset-Generation" title="Link to this heading"></a></h2>
<p>Aside the provided datasets that come with the CityLearn installation, custom single-family residential datasets can be generated in CityLearn by taking advantage of the <a class="reference external" href="https://www.nrel.gov/buildings/end-use-load-profiles.html">End-Use Load Profiles for the U.S. Building Stock dataset</a>. The <a class="reference external" href="https://www.citylearn.net/api/citylearn.end_use_load_profiles.neighborhood.html#citylearn.end_use_load_profiles.neighborhood.Neighborhood">citylearn.end_use_load_profiles.neighborhood.Neighborhood</a>
class makes this possible.</p>
<p>To learn more about the methodology used in this feature, refer to the <a class="reference external" href="https://doi.org/10.1080/19401493.2024.2418813">CityLearn v2 paper</a>.</p>
<p>Note that to make use of this feature, <a class="reference external" href="https://github.com/NREL/EnergyPlus/releases/tag/v9.6.0">EnergyPlus 9.6.0</a> must be installed. Other EnergyPlus versions are not yet supported.</p>
<p>An example of a generating a dataset and using it in simulation is:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.agents.rbc</span><span class="w"> </span><span class="kn">import</span> <span class="n">BasicRBC</span> <span class="k">as</span> <span class="n">Agent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.citylearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">CityLearnEnv</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">citylearn.end_use_load_profiles.neighborhood</span><span class="w"> </span><span class="kn">import</span> <span class="n">Neighborhood</span><span class="p">,</span> <span class="n">SampleMethod</span>

<span class="c1"># path to version EnergyPlus 9.6.0 IDD</span>
<span class="n">idd_filepath</span> <span class="o">=</span> <span class="s1">&#39;/Applications/EnergyPlus-9-6-0/PreProcess/IDFVersionUpdater/V9-6-0-Energy+.idd&#39;</span>

<span class="c1"># build a neighborhood with n buildings through random sampling of single-family residential buildings in EULP dataset.</span>
<span class="c1"># Sampling population is filtered to include specific county and building vintage.</span>
<span class="c1"># train their LSTM thermal dynamics models and generate a CityLearn schema for the two buildings</span>
<span class="n">neighborhood</span> <span class="o">=</span> <span class="n">Neighborhood</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">neighborhood_build</span> <span class="o">=</span> <span class="n">neighborhood</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
    <span class="n">idd_filepath</span><span class="o">=</span><span class="n">idd_filepath</span><span class="p">,</span>
    <span class="n">delete_energyplus_simulation_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sample_buildings_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">sample_method</span><span class="o">=</span><span class="n">SampleMethod</span><span class="o">.</span><span class="n">RANDOM</span><span class="p">,</span>
        <span class="n">sample_count</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;in.resstock_county_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;TX, Travis County&#39;</span><span class="p">],</span>
            <span class="s1">&#39;in.vintage&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2000s&#39;</span><span class="p">]</span>
        <span class="p">},</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="c1"># simulate neighborhood in CityLearn</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CityLearnEnv</span><span class="p">(</span><span class="n">neighborhood_build</span><span class="o">.</span><span class="n">schema_filepath</span><span class="p">,</span> <span class="n">central_agent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="n">observations</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="k">while</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">terminated</span><span class="p">:</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
    <span class="n">observations</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">terminated</span><span class="p">,</span> <span class="n">truncated</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="n">kpis</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;cost_function&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kpis</span> <span class="o">=</span> <span class="n">kpis</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="overview/index.html" class="btn btn-neutral float-right" title="Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Jose Ramon Vazquez-Canteli, Kingsley Nweye, Zoltan Nagy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>